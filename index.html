<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Zikirmatik - Dijital Tesbih</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@300;400;600;700&family=Manrope:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #FAFAFA;
            --bg-secondary: #FFFFFF;
            --text-primary: #1A1A1A;
            --text-secondary: #666666;
            --accent: #2D5F3F;
            --accent-light: #4A8C5F;
            --accent-glow: rgba(45, 95, 63, 0.15);
            --border: #E5E5E5;
            --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.04);
            --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.08);
            --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.12);
            --radius: 24px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Manrope', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            overflow-x: hidden;
            min-height: 100vh;
            position: relative;
        }

        /* Decorative Background Pattern */
        body::before {
            content: '';
            position: fixed;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: 
                radial-gradient(circle at 20% 30%, var(--accent-glow) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(45, 95, 63, 0.08) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
            animation: floatPattern 60s ease-in-out infinite;
        }

        @keyframes floatPattern {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            33% { transform: translate(-5%, 5%) rotate(3deg); }
            66% { transform: translate(5%, -5%) rotate(-3deg); }
        }

        /* Header */
        header {
            position: sticky;
            top: 0;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
            padding: 1.25rem 1.5rem;
            z-index: 100;
            box-shadow: var(--shadow-sm);
            backdrop-filter: blur(20px);
            background: rgba(255, 255, 255, 0.95);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 600px;
            margin: 0 auto;
        }

        .logo {
            font-family: 'Crimson Pro', serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--accent);
            letter-spacing: -0.02em;
        }

        .hamburger {
            background: none;
            border: none;
            cursor: pointer;
            padding: 0.5rem;
            display: flex;
            flex-direction: column;
            gap: 5px;
            transition: transform 0.3s ease;
        }

        .hamburger:hover {
            transform: scale(1.05);
        }

        .hamburger.active {
            transform: rotate(90deg);
        }

        .hamburger span {
            width: 24px;
            height: 2.5px;
            background: var(--text-primary);
            border-radius: 2px;
            transition: all 0.3s ease;
        }

        .hamburger.active span:nth-child(1) {
            transform: rotate(45deg) translate(6px, 6px);
        }

        .hamburger.active span:nth-child(2) {
            opacity: 0;
        }

        .hamburger.active span:nth-child(3) {
            transform: rotate(-45deg) translate(6px, -6px);
        }

        /* Main Content */
        main {
            max-width: 600px;
            margin: 0 auto;
            padding: 2rem 1.5rem;
            position: relative;
            z-index: 1;
        }

        /* Zikir Display */
        .zikir-display {
            text-align: center;
            margin-bottom: 3rem;
            animation: fadeInUp 0.6s ease;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .zikir-name {
            font-family: 'Crimson Pro', serif;
            font-size: 1.75rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 1rem;
            line-height: 1.3;
            letter-spacing: -0.01em;
        }

        .count-display {
            font-size: 4rem;
            font-weight: 700;
            color: var(--accent);
            margin-bottom: 0.5rem;
            font-variant-numeric: tabular-nums;
            line-height: 1;
            text-shadow: 0 2px 8px var(--accent-glow);
        }

        .target-info {
            font-size: 0.95rem;
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        /* Progress Bar */
        .progress-container {
            width: 100%;
            height: 8px;
            background: var(--border);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 0.5rem;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--accent), var(--accent-light));
            border-radius: 4px;
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 0 8px var(--accent-glow);
        }

        .progress-text {
            font-size: 0.85rem;
            color: var(--text-secondary);
            text-align: center;
        }

        /* Counter Button */
        .counter-button {
            width: 220px;
            height: 220px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent) 0%, var(--accent-light) 100%);
            border: none;
            color: white;
            font-size: 1.5rem;
            font-weight: 600;
            cursor: pointer;
            margin: 2rem auto;
            display: block;
            box-shadow: 
                var(--shadow-lg),
                0 0 40px var(--accent-glow),
                inset 0 -4px 16px rgba(0, 0, 0, 0.15);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .counter-button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .counter-button:active::before {
            width: 300px;
            height: 300px;
        }

        .counter-button:active {
            transform: scale(0.95);
            box-shadow: 
                var(--shadow-md),
                0 0 20px var(--accent-glow),
                inset 0 -2px 8px rgba(0, 0, 0, 0.2);
        }

        .counter-button:hover {
            transform: scale(1.05);
            box-shadow: 
                0 12px 40px rgba(0, 0, 0, 0.15),
                0 0 60px var(--accent-glow);
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-top: 3rem;
        }

        .stat-card {
            background: var(--bg-secondary);
            padding: 1.5rem;
            border-radius: 16px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 500;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--accent);
            font-variant-numeric: tabular-nums;
        }

        /* Side Menu */
        .side-menu {
            position: fixed;
            top: 0;
            right: -100%;
            width: 90%;
            max-width: 400px;
            height: 100vh;
            background: var(--bg-secondary);
            box-shadow: -4px 0 32px rgba(0, 0, 0, 0.1);
            z-index: 200;
            transition: right 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            overflow-y: auto;
        }

        .side-menu.active {
            right: 0;
        }

        .menu-header {
            padding: 2rem 1.5rem 1.5rem;
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 0;
            background: var(--bg-secondary);
            z-index: 10;
        }

        .menu-title {
            font-family: 'Crimson Pro', serif;
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--accent);
            margin-bottom: 0.5rem;
        }

        .menu-subtitle {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .menu-content {
            padding: 1.5rem;
        }

        /* Menu Sections */
        .menu-section {
            margin-bottom: 2rem;
        }

        .section-title {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.08em;
            margin-bottom: 1rem;
        }

        /* Zikir List */
        .zikir-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .zikir-item {
            background: var(--bg-primary);
            padding: 1.25rem;
            border-radius: 12px;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .zikir-item:hover {
            border-color: var(--accent-light);
            transform: translateX(4px);
        }

        .zikir-item.active {
            border-color: var(--accent);
            background: linear-gradient(135deg, rgba(45, 95, 63, 0.05), rgba(74, 140, 95, 0.05));
        }

        .zikir-item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.75rem;
        }

        .zikir-item-name {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 1rem;
            flex: 1;
        }

        .zikir-item-count {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--accent);
            font-variant-numeric: tabular-nums;
        }

        .zikir-item-progress {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .zikir-item-bar {
            height: 4px;
            background: var(--border);
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 0.75rem;
        }

        .zikir-item-bar-fill {
            height: 100%;
            background: var(--accent);
            border-radius: 2px;
            transition: width 0.3s ease;
        }

        .zikir-item-actions {
            display: flex;
            gap: 0.5rem;
        }

        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: inherit;
        }

        .btn-small {
            padding: 0.4rem 0.75rem;
            font-size: 0.8rem;
        }

        .btn-primary {
            background: var(--accent);
            color: white;
        }

        .btn-primary:hover {
            background: var(--accent-light);
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: var(--bg-secondary);
            color: var(--text-secondary);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--bg-primary);
            border-color: var(--accent);
        }

        .btn-danger {
            background: #DC2626;
            color: white;
        }

        .btn-danger:hover {
            background: #B91C1C;
        }

        /* Add New Zikir */
        .add-zikir-form {
            background: var(--bg-primary);
            padding: 1.25rem;
            border-radius: 12px;
            border: 2px dashed var(--border);
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group:last-child {
            margin-bottom: 0;
        }

        .form-label {
            display: block;
            font-size: 0.85rem;
            font-weight: 500;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .form-input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 0.95rem;
            font-family: inherit;
            background: var(--bg-secondary);
            color: var(--text-primary);
            transition: all 0.2s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px var(--accent-glow);
        }

        /* Settings */
        .settings-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .setting-item {
            background: var(--bg-primary);
            padding: 1rem 1.25rem;
            border-radius: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .setting-label {
            font-size: 0.95rem;
            color: var(--text-primary);
        }

        /* Toggle Switch */
        .toggle {
            position: relative;
            width: 48px;
            height: 24px;
        }

        .toggle input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--border);
            transition: 0.3s;
            border-radius: 24px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background: white;
            transition: 0.3s;
            border-radius: 50%;
        }

        .toggle input:checked + .toggle-slider {
            background: var(--accent);
        }

        .toggle input:checked + .toggle-slider:before {
            transform: translateX(24px);
        }

        /* Modal/Popup */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            z-index: 300;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: flex;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: var(--bg-secondary);
            padding: 2rem;
            border-radius: var(--radius);
            max-width: 400px;
            width: 90%;
            box-shadow: var(--shadow-lg);
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 1rem;
        }

        .modal-text {
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }

        .modal-actions {
            display: flex;
            gap: 0.75rem;
        }

        .modal-actions .btn {
            flex: 1;
        }

        /* Overlay */
        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(2px);
            z-index: 150;
            transition: opacity 0.3s ease;
        }

        .overlay.active {
            display: block;
        }

        /* Search Filter */
        .search-box {
            margin-bottom: 1rem;
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: var(--text-primary);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            box-shadow: var(--shadow-lg);
            z-index: 400;
            opacity: 0;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            max-width: 90%;
        }

        .toast.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

        /* File Input Custom */
        .file-input-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
            width: 100%;
        }

        .file-input-wrapper input[type=file] {
            position: absolute;
            left: -9999px;
        }

        /* Responsive */
        @media (max-width: 480px) {
            .count-display {
                font-size: 3.5rem;
            }

            .counter-button {
                width: 180px;
                height: 180px;
            }

            .zikir-name {
                font-size: 1.5rem;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Loading Animation */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .loading {
            animation: pulse 1.5s ease-in-out infinite;
        }

        /* Ripple Effect */
        @keyframes ripple {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="header-content">
            <div class="logo">Zikirmatik</div>
            <button class="hamburger" id="menuToggle" aria-label="Men√º">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </header>

    <!-- Main Content -->
    <main>
        <!-- Zikir Display -->
        <div class="zikir-display">
            <h1 class="zikir-name" id="currentZikirName">ƒ∞HLAS-I ≈ûERƒ∞F</h1>
            <div class="count-display" id="currentCount">0</div>
            <div class="target-info">
                Hedef: <span id="currentTarget">40000</span> | 
                Kalan: <span id="remaining">40000</span>
            </div>
            <div class="progress-container">
                <div class="progress-bar" id="progressBar" style="width: 0%"></div>
            </div>
            <div class="progress-text" id="progressText">%0 tamamlandƒ±</div>
        </div>

        <!-- Counter Button -->
        <button class="counter-button" id="counterButton" aria-label="Saya√ß Artƒ±r">
            Zikir Say
        </button>

        <!-- Stats Grid -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">Bug√ºn</div>
                <div class="stat-value" id="todayCount">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Toplam</div>
                <div class="stat-value" id="totalCount">0</div>
            </div>
        </div>
    </main>

    <!-- Side Menu -->
    <div class="side-menu" id="sideMenu">
        <div class="menu-header">
            <h2 class="menu-title">Zikirlerim</h2>
            <p class="menu-subtitle">T√ºm zikirlerinizi y√∂netin</p>
        </div>
        <div class="menu-content">
            <!-- Search -->
            <div class="menu-section">
                <input type="text" class="form-input search-box" id="searchBox" placeholder="üîç Zikir ara...">
            </div>

            <!-- Zikir List -->
            <div class="menu-section">
                <h3 class="section-title">Kayƒ±tlƒ± Zikirler</h3>
                <div class="zikir-list" id="zikirList"></div>
            </div>

            <!-- Add New Zikir -->
            <div class="menu-section">
                <h3 class="section-title">Yeni Zikir Ekle</h3>
                <div class="add-zikir-form">
                    <div class="form-group">
                        <label class="form-label">Zikir Adƒ±</label>
                        <input type="text" class="form-input" id="newZikirName" placeholder="√ñrn: Subhanallah">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Hedef Sayƒ±</label>
                        <input type="number" class="form-input" id="newZikirTarget" placeholder="√ñrn: 1000" value="1000">
                    </div>
                    <button class="btn btn-primary" id="addZikirBtn" style="width: 100%;">Ekle</button>
                </div>
            </div>

            <!-- Settings -->
            <div class="menu-section">
                <h3 class="section-title">Ayarlar</h3>
                <div class="settings-list">
                    <div class="setting-item">
                        <span class="setting-label">Ses Efekti</span>
                        <label class="toggle">
                            <input type="checkbox" id="soundToggle" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <span class="setting-label">Titre≈üim</span>
                        <label class="toggle">
                            <input type="checkbox" id="vibrationToggle" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Data Management -->
            <div class="menu-section">
                <h3 class="section-title">Veri Y√∂netimi</h3>
                <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                    <button class="btn btn-secondary" id="exportBtn">üì• Verileri Dƒ±≈üa Aktar</button>
                    <div class="file-input-wrapper">
                        <button class="btn btn-secondary" style="width: 100%;">üì§ Verileri ƒ∞√ße Aktar</button>
                        <input type="file" id="importFile" accept=".json">
                    </div>
                    <button class="btn btn-danger" id="resetAllBtn">üóëÔ∏è T√ºm Verileri Sƒ±fƒ±rla</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Overlay -->
    <div class="overlay" id="overlay"></div>

    <!-- Confirmation Modal -->
    <div class="modal" id="confirmModal">
        <div class="modal-content">
            <h3 class="modal-title" id="modalTitle">Emin misiniz?</h3>
            <p class="modal-text" id="modalText">Bu i≈ülem geri alƒ±namaz.</p>
            <div class="modal-actions">
                <button class="btn btn-secondary" id="modalCancel">ƒ∞ptal</button>
                <button class="btn btn-danger" id="modalConfirm">Onayla</button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <script>
        // ============================================
        // Zƒ∞Kƒ∞RMATƒ∞K APP - COMPLETE IMPLEMENTATION
        // ============================================

        class ZikirmatikApp {
            constructor() {
                this.currentZikirId = null;
                this.zikirler = [];
                this.settings = {
                    sound: true,
                    vibration: true
                };
                this.dailyStats = {};
                
                this.init();
            }

            // ========== INITIALIZATION ==========
            init() {
                this.loadData();
                this.setupEventListeners();
                this.updateUI();
                this.updateStats();
            }

            // ========== DATA MANAGEMENT ==========
            loadData() {
                // Load zikirler from localStorage
                const saved = localStorage.getItem('zikirmatik_data');
                if (saved) {
                    const data = JSON.parse(saved);
                    this.zikirler = data.zikirler || [];
                    this.currentZikirId = data.currentZikirId || null;
                    this.settings = data.settings || this.settings;
                    this.dailyStats = data.dailyStats || {};
                } else {
                    // ƒ∞lk kurulum - varsayƒ±lan zikirler
                    this.initializeDefaultZikirler();
                }

                // Eƒüer currentZikirId yoksa veya ge√ßersizse, ilk zikri se√ß
                if (!this.currentZikirId || !this.zikirler.find(z => z.id === this.currentZikirId)) {
                    this.currentZikirId = this.zikirler.length > 0 ? this.zikirler[0].id : null;
                }

                this.cleanOldDailyStats();
            }

            initializeDefaultZikirler() {
                const defaults = [
                    { name: 'ƒ∞HLAS-I ≈ûERƒ∞F', target: 40000 },
                    { name: 'NAMAZ SONRASI 33 SUBHANALLAH', target: 33 },
                    { name: 'NAMAZ SONRASI 33 ELHAMD√úLƒ∞LLAH', target: 33 },
                    { name: 'NAMAZ SONRASI 34 ALLAHU EKBER', target: 34 },
                    { name: 'ESTAƒûFƒ∞RULLAH', target: 100 },
                    { name: 'LA ƒ∞LAHE ƒ∞LLALLAH', target: 100 },
                    { name: 'ALLAH√úMME SALLƒ∞ ALA SEYYƒ∞Dƒ∞NA MUHAMMED', target: 100 },
                    { name: 'AYET√úL K√úRSƒ∞', target: 100 }
                ];

                this.zikirler = defaults.map((z, index) => ({
                    id: this.generateId(),
                    name: z.name,
                    count: 0,
                    target: z.target,
                    createdAt: Date.now()
                }));

                this.currentZikirId = this.zikirler[0].id;
                this.saveData();
            }

            saveData() {
                const data = {
                    zikirler: this.zikirler,
                    currentZikirId: this.currentZikirId,
                    settings: this.settings,
                    dailyStats: this.dailyStats,
                    lastUpdate: Date.now()
                };
                localStorage.setItem('zikirmatik_data', JSON.stringify(data));
            }

            generateId() {
                return Date.now().toString(36) + Math.random().toString(36).substr(2);
            }

            // ========== DAILY STATS MANAGEMENT ==========
            getTodayKey() {
                const today = new Date();
                return `${today.getFullYear()}-${today.getMonth() + 1}-${today.getDate()}`;
            }

            cleanOldDailyStats() {
                // Son 30 g√ºnden eski istatistikleri temizle
                const thirtyDaysAgo = Date.now() - (30 * 24 * 60 * 60 * 1000);
                const keys = Object.keys(this.dailyStats);
                
                keys.forEach(key => {
                    const [year, month, day] = key.split('-').map(Number);
                    const date = new Date(year, month - 1, day);
                    if (date.getTime() < thirtyDaysAgo) {
                        delete this.dailyStats[key];
                    }
                });
            }

            incrementDailyCount() {
                const today = this.getTodayKey();
                if (!this.dailyStats[today]) {
                    this.dailyStats[today] = 0;
                }
                this.dailyStats[today]++;
            }

            getTodayCount() {
                const today = this.getTodayKey();
                return this.dailyStats[today] || 0;
            }

            // ========== ZIKIR OPERATIONS ==========
            getCurrentZikir() {
                return this.zikirler.find(z => z.id === this.currentZikirId);
            }

            incrementCount() {
                const zikir = this.getCurrentZikir();
                if (!zikir) return;

                zikir.count++;
                this.incrementDailyCount();
                
                // Ses √ßal
                if (this.settings.sound) {
                    this.playSound();
                }

                // Titre≈üim
                if (this.settings.vibration && navigator.vibrate) {
                    navigator.vibrate(50);
                }

                this.saveData();
                this.updateUI();
                this.updateStats();

                // Hedef tamamlandƒ±ysa tebrik g√∂ster
                if (zikir.count === zikir.target) {
                    this.showToast(`üéâ ${zikir.name} hedefini tamamladƒ±nƒ±z!`);
                }
            }

            addZikir(name, target) {
                if (!name.trim()) {
                    this.showToast('‚ö†Ô∏è Zikir adƒ± bo≈ü olamaz!');
                    return;
                }

                const newZikir = {
                    id: this.generateId(),
                    name: name.trim().toUpperCase(),
                    count: 0,
                    target: parseInt(target) || 1000,
                    createdAt: Date.now()
                };

                this.zikirler.push(newZikir);
                this.saveData();
                this.renderZikirList();
                this.showToast('‚úÖ Yeni zikir eklendi!');

                // Form temizle
                document.getElementById('newZikirName').value = '';
                document.getElementById('newZikirTarget').value = '1000';
            }

            deleteZikir(id) {
                const zikir = this.zikirler.find(z => z.id === id);
                if (!zikir) return;

                this.showConfirmModal(
                    'Zikri Sil',
                    `"${zikir.name}" adlƒ± zikri silmek istediƒüinize emin misiniz? Bu i≈ülem geri alƒ±namaz.`,
                    () => {
                        this.zikirler = this.zikirler.filter(z => z.id !== id);
                        
                        // Silinen zikir aktifse, ba≈üka bir zikri aktif yap
                        if (this.currentZikirId === id) {
                            this.currentZikirId = this.zikirler.length > 0 ? this.zikirler[0].id : null;
                        }

                        this.saveData();
                        this.renderZikirList();
                        this.updateUI();
                        this.showToast('üóëÔ∏è Zikir silindi!');
                    }
                );
            }

            resetZikir(id) {
                const zikir = this.zikirler.find(z => z.id === id);
                if (!zikir) return;

                this.showConfirmModal(
                    'Sayacƒ± Sƒ±fƒ±rla',
                    `"${zikir.name}" sayacƒ±nƒ± sƒ±fƒ±rlamak istediƒüinize emin misiniz?`,
                    () => {
                        zikir.count = 0;
                        this.saveData();
                        this.renderZikirList();
                        this.updateUI();
                        this.showToast('üîÑ Saya√ß sƒ±fƒ±rlandƒ±!');
                    }
                );
            }

            selectZikir(id) {
                this.currentZikirId = id;
                this.saveData();
                this.updateUI();
                this.renderZikirList();
                
                // Men√ºy√º kapat
                this.closeMenu();
            }

            // ========== UI UPDATES ==========
            updateUI() {
                const zikir = this.getCurrentZikir();
                if (!zikir) {
                    document.getElementById('currentZikirName').textContent = 'Zikir se√ßilmedi';
                    document.getElementById('currentCount').textContent = '0';
                    document.getElementById('currentTarget').textContent = '0';
                    document.getElementById('remaining').textContent = '0';
                    document.getElementById('progressBar').style.width = '0%';
                    document.getElementById('progressText').textContent = '%0 tamamlandƒ±';
                    return;
                }

                document.getElementById('currentZikirName').textContent = zikir.name;
                document.getElementById('currentCount').textContent = zikir.count.toLocaleString('tr-TR');
                document.getElementById('currentTarget').textContent = zikir.target.toLocaleString('tr-TR');
                
                const remaining = Math.max(0, zikir.target - zikir.count);
                document.getElementById('remaining').textContent = remaining.toLocaleString('tr-TR');

                const progress = Math.min(100, (zikir.count / zikir.target) * 100);
                document.getElementById('progressBar').style.width = progress + '%';
                document.getElementById('progressText').textContent = `%${progress.toFixed(1)} tamamlandƒ±`;
            }

            updateStats() {
                const todayCount = this.getTodayCount();
                const totalCount = this.zikirler.reduce((sum, z) => sum + z.count, 0);

                document.getElementById('todayCount').textContent = todayCount.toLocaleString('tr-TR');
                document.getElementById('totalCount').textContent = totalCount.toLocaleString('tr-TR');
            }

            renderZikirList() {
                const container = document.getElementById('zikirList');
                const searchTerm = document.getElementById('searchBox').value.toLowerCase();
                
                const filtered = this.zikirler.filter(z => 
                    z.name.toLowerCase().includes(searchTerm)
                );

                // Sƒ±rala: Aktif zikir en √ºstte, sonra isme g√∂re
                filtered.sort((a, b) => {
                    if (a.id === this.currentZikirId) return -1;
                    if (b.id === this.currentZikirId) return 1;
                    return a.name.localeCompare(b.name, 'tr');
                });

                container.innerHTML = filtered.map(zikir => {
                    const progress = Math.min(100, (zikir.count / zikir.target) * 100);
                    const isActive = zikir.id === this.currentZikirId;

                    return `
                        <div class="zikir-item ${isActive ? 'active' : ''}" data-id="${zikir.id}">
                            <div class="zikir-item-header">
                                <div class="zikir-item-name">${zikir.name}</div>
                                <div class="zikir-item-count">${zikir.count.toLocaleString('tr-TR')}</div>
                            </div>
                            <div class="zikir-item-progress">Hedef: ${zikir.target.toLocaleString('tr-TR')}</div>
                            <div class="zikir-item-bar">
                                <div class="zikir-item-bar-fill" style="width: ${progress}%"></div>
                            </div>
                            <div class="zikir-item-actions">
                                <button class="btn btn-small btn-primary select-zikir" data-id="${zikir.id}">
                                    ${isActive ? '‚úì Se√ßili' : 'Se√ß'}
                                </button>
                                <button class="btn btn-small btn-secondary reset-zikir" data-id="${zikir.id}">Sƒ±fƒ±rla</button>
                                <button class="btn btn-small btn-danger delete-zikir" data-id="${zikir.id}">Sil</button>
                            </div>
                        </div>
                    `;
                }).join('');

                // Event listeners
                container.querySelectorAll('.select-zikir').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        this.selectZikir(btn.dataset.id);
                    });
                });

                container.querySelectorAll('.reset-zikir').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        this.resetZikir(btn.dataset.id);
                    });
                });

                container.querySelectorAll('.delete-zikir').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        this.deleteZikir(btn.dataset.id);
                    });
                });

                // Tƒ±klayarak se√ßme
                container.querySelectorAll('.zikir-item').forEach(item => {
                    item.addEventListener('click', () => {
                        this.selectZikir(item.dataset.id);
                    });
                });
            }

            // ========== MENU CONTROLS ==========
            toggleMenu() {
                const menu = document.getElementById('sideMenu');
                const overlay = document.getElementById('overlay');
                const hamburger = document.getElementById('menuToggle');

                menu.classList.toggle('active');
                overlay.classList.toggle('active');
                hamburger.classList.toggle('active');

                if (menu.classList.contains('active')) {
                    this.renderZikirList();
                }
            }

            closeMenu() {
                document.getElementById('sideMenu').classList.remove('active');
                document.getElementById('overlay').classList.remove('active');
                document.getElementById('menuToggle').classList.remove('active');
            }

            // ========== MODAL & TOAST ==========
            showConfirmModal(title, text, onConfirm) {
                const modal = document.getElementById('confirmModal');
                document.getElementById('modalTitle').textContent = title;
                document.getElementById('modalText').textContent = text;
                
                modal.classList.add('active');

                const confirmBtn = document.getElementById('modalConfirm');
                const cancelBtn = document.getElementById('modalCancel');

                const confirm = () => {
                    onConfirm();
                    modal.classList.remove('active');
                    cleanup();
                };

                const cancel = () => {
                    modal.classList.remove('active');
                    cleanup();
                };

                const cleanup = () => {
                    confirmBtn.removeEventListener('click', confirm);
                    cancelBtn.removeEventListener('click', cancel);
                };

                confirmBtn.addEventListener('click', confirm);
                cancelBtn.addEventListener('click', cancel);
            }

            showToast(message) {
                const toast = document.getElementById('toast');
                toast.textContent = message;
                toast.classList.add('show');

                setTimeout(() => {
                    toast.classList.remove('show');
                }, 3000);
            }

            // ========== DATA IMPORT/EXPORT ==========
            exportData() {
                const data = {
                    zikirler: this.zikirler,
                    settings: this.settings,
                    dailyStats: this.dailyStats,
                    exportDate: new Date().toISOString(),
                    version: '1.0'
                };

                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `zikirmatik-yedek-${Date.now()}.json`;
                a.click();
                URL.revokeObjectURL(url);

                this.showToast('üì• Veriler dƒ±≈üa aktarƒ±ldƒ±!');
            }

            importData(file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const data = JSON.parse(e.target.result);
                        
                        if (!data.zikirler || !Array.isArray(data.zikirler)) {
                            throw new Error('Ge√ßersiz dosya formatƒ±');
                        }

                        this.zikirler = data.zikirler;
                        this.settings = data.settings || this.settings;
                        this.dailyStats = data.dailyStats || {};
                        
                        if (!this.zikirler.find(z => z.id === this.currentZikirId)) {
                            this.currentZikirId = this.zikirler[0]?.id || null;
                        }

                        this.saveData();
                        this.updateUI();
                        this.updateStats();
                        this.renderZikirList();
                        this.showToast('üì§ Veriler i√ße aktarƒ±ldƒ±!');
                    } catch (error) {
                        this.showToast('‚ùå Hata: Ge√ßersiz dosya!');
                    }
                };
                reader.readAsText(file);
            }

            resetAllData() {
                this.showConfirmModal(
                    'T√ºm Verileri Sƒ±fƒ±rla',
                    'T√úM zikirleriniz ve istatistikleriniz silinecek. Bu i≈ülem geri alƒ±namaz!',
                    () => {
                        localStorage.removeItem('zikirmatik_data');
                        this.zikirler = [];
                        this.dailyStats = {};
                        this.initializeDefaultZikirler();
                        this.updateUI();
                        this.updateStats();
                        this.renderZikirList();
                        this.showToast('üóëÔ∏è T√ºm veriler sƒ±fƒ±rlandƒ±!');
                    }
                );
            }

            // ========== SOUND ==========
            playSound() {
                // Web Audio API ile basit beep sesi
                try {
                    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();

                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);

                    oscillator.frequency.value = 800;
                    oscillator.type = 'sine';
                    
                    gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);

                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.1);
                } catch (e) {
                    // Ses √ßalƒ±namazsa sessizce devam et
                }
            }

            // ========== EVENT LISTENERS ==========
            setupEventListeners() {
                // Counter button
                document.getElementById('counterButton').addEventListener('click', () => {
                    this.incrementCount();
                });

                // Menu toggle
                document.getElementById('menuToggle').addEventListener('click', () => {
                    this.toggleMenu();
                });

                // Overlay (men√º dƒ±≈üƒ±na tƒ±klama)
                document.getElementById('overlay').addEventListener('click', () => {
                    this.closeMenu();
                });

                // Add zikir
                document.getElementById('addZikirBtn').addEventListener('click', () => {
                    const name = document.getElementById('newZikirName').value;
                    const target = document.getElementById('newZikirTarget').value;
                    this.addZikir(name, target);
                });

                // Enter tu≈üu ile ekle
                document.getElementById('newZikirName').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        document.getElementById('addZikirBtn').click();
                    }
                });

                // Search
                document.getElementById('searchBox').addEventListener('input', () => {
                    this.renderZikirList();
                });

                // Settings
                document.getElementById('soundToggle').addEventListener('change', (e) => {
                    this.settings.sound = e.target.checked;
                    this.saveData();
                });

                document.getElementById('vibrationToggle').addEventListener('change', (e) => {
                    this.settings.vibration = e.target.checked;
                    this.saveData();
                });

                // Load settings
                document.getElementById('soundToggle').checked = this.settings.sound;
                document.getElementById('vibrationToggle').checked = this.settings.vibration;

                // Export
                document.getElementById('exportBtn').addEventListener('click', () => {
                    this.exportData();
                });

                // Import
                document.getElementById('importFile').addEventListener('change', (e) => {
                    const file = e.target.files[0];
                    if (file) {
                        this.importData(file);
                        e.target.value = ''; // Reset input
                    }
                });

                // Reset all
                document.getElementById('resetAllBtn').addEventListener('click', () => {
                    this.resetAllData();
                });

                // Spacebar ile saya√ß artƒ±rma
                document.addEventListener('keydown', (e) => {
                    if (e.code === 'Space' && !e.target.matches('input, textarea')) {
                        e.preventDefault();
                        this.incrementCount();
                    }
                });
            }
        }

        // ========== APP INITIALIZATION ==========
        const app = new ZikirmatikApp();

        // Service Worker for offline support (optional)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                // Not implementing full service worker in this version
                // But the app works fully offline with localStorage
            });
        }
    </script>
</body>
</html>
